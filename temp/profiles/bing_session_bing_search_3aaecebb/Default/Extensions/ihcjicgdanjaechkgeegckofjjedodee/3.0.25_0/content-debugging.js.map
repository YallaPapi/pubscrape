{"version":3,"file":"content-debugging.js","mappings":"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","sources":["webpack://browser-guard/./guard-app/content-scripts/heuristics-db/types.ts","webpack://browser-guard/./guard-app/content-scripts/heuristics-db/selector-parser.ts","webpack://browser-guard/./guard-app/app/scripts/app-consts.js","webpack://browser-guard/./guard-app/content-scripts/heuristics-db/content-heuristics.ts","webpack://browser-guard/webpack/bootstrap","webpack://browser-guard/webpack/runtime/define property getters","webpack://browser-guard/webpack/runtime/hasOwnProperty shorthand","webpack://browser-guard/webpack/runtime/publicPath","webpack://browser-guard/./configure-webpack.js","webpack://browser-guard/./guard-app/utils/polyfill.ts","webpack://browser-guard/./node_modules/dompurify/dist/purify.es.mjs","webpack://browser-guard/./guard-app/content-scripts/content-debugging.js"],"sourcesContent":["export type SelectorObj = {\n    selector: string;\n    isSilent: boolean;\n    isAggressiveMode?: boolean;\n    id: number;\n  };\n\n  export enum ElementHidingSelectors {\n      \"#?#\"='extended_selectors',\n      \"##\"='basic_selectors',\n  }\n  export enum Actions {\n    CLICK_ON_ELEMENT = \"click\",\n    REMOVE_ELEMENT = \"remove\",\n  }\n\n  export enum RuleType {\n    ADSERVER = \"adserver\",\n    SCAM = \"scam\",\n    PHISHING = \"phishing\",\n    ACTION = \"action\",\n  }\n  export type DomainRules = {\n    [key in ElementHidingSelectors]: SelectorObj[];\n  }|{};\n\n  export interface HeuristicRule {\n    r: string; // rule\n    s?: boolean; // silent flag\n    t:RuleType ; // type\n    a?: boolean;\n    d?: string; // description\n    id: number;\n  }\n\n  export type HeuristicsRulesParams = {\n    isSilent?: boolean; // silent flag\n    isAggressiveMode?: boolean;\n    id: number;\n  };\n  \n  export type BlockURL = {\n    domain: string;\n    isSilent: boolean;\n    isAggressiveMode: boolean;\n    type: RuleType;\n    source: string;\n    id: number;\n  } & HeuristicsRulesParams;\n\n  export interface ProcessedRules {\n    adserver: DomainRules;\n    whitelist: Record<string, unknown>;\n    scam: DomainRules;\n    phishing: DomainRules;\n    action: unknown[];\n    title: string[];\n    description: string[];\n    cleanName: string;\n    version: string;\n    name: string;\n  }\n\n  export type SelectorType =\n    | \"plain\"\n    | \"not\"\n    | \"has\"\n    | \"contains\"\n    | \"comments\"\n    | \"xpath\"\n    | \"properties\"\n    | \"fmd5\";\n  export type ActionSelectorType = \"click\"| \"remove\";\n\n  export interface BaseSelector {\n    type: SelectorType;\n    raw: string;\n  }\n\n  export interface BaseActionSelector {\n    type: ActionSelectorType;\n    raw: string;\n  }\n\n  export interface PlainSelector extends BaseSelector {\n    type: \"plain\";\n    action?: Actions;\n    selector: string;\n  }\n\n  export interface NotSelector extends BaseSelector {\n    type: \"not\";\n    selectors: Selector[];\n  }\n\n  export interface HasSelector extends BaseSelector {\n    type: \"has\";\n    selectors: Selector[];\n  }\n\n  export interface ContainsSelector extends BaseSelector {\n    type: \"contains\";\n    text: string;\n  }\n\n  export interface CommentsSelector extends BaseSelector {\n    type: \"comments\";\n    text: string;\n  }\n\n  export interface XPathSelector extends BaseSelector {\n    type: \"xpath\";\n    xpath: string;\n  }\n  export interface ClickAction extends BaseActionSelector {\n    type: \"click\";\n    selector: string;\n  }\n  export interface RemoveAction extends BaseActionSelector {\n    type: \"remove\";\n    selector: string;\n  }\n  export interface PropertiesSelector extends BaseSelector {\n    type: \"properties\";\n    propertyFilter: string;\n  }\n  \n  export interface FaviconMd5Selector extends BaseSelector {\n    type: \"fmd5\";\n    hash: string;\n    isSilent?: boolean;\n    isAggressiveMode?: boolean;\n    id?: number;\n    ruleType?: RuleType;\n  }\n\n  export type Selector =\n    | PlainSelector\n    | NotSelector\n    | HasSelector\n    | ContainsSelector\n    | CommentsSelector\n    | XPathSelector\n    | PropertiesSelector\n    | ClickAction\n    | RemoveAction\n    | FaviconMd5Selector;\n\n  export const COMPLEX_OPERATORS_REGEX = /:([\\w-]+|contains|xpath|properties|has|not|fmd5)\\(/i;\n  export const ACTION_OPERATORS_REGEX = /^(.*?):(click|remove)\\(/i;\n","import {\n  ACTION_OPERATORS_REGEX,\n  Selector,\n  COMPLEX_OPERATORS_REGEX, Actions,\n  RuleType,\n} from \"@/content-scripts/heuristics-db/types\";\n\nexport class SelectorParser {\n  private parseSelectorContent(\n    content: string,\n    startIndex: number\n  ): { text: string; end: number } | null {\n    let parens = 1;\n    let quote: string | null = null;\n    let i = startIndex;\n\n    for (; i < content.length; i++) {\n      const c = content[i];\n\n      if (c === \"\\\\\") {\n        // Skip escaped characters\n        i++;\n        continue;\n      }\n\n      if (c === \"(\") {\n        parens++;\n      } else if (c === \")\") {\n        parens--;\n        if (parens === 0) {\n          break;\n        }\n      }\n    }\n\n    if (parens > 0) {\n      return null;\n    }\n\n    return {\n      text: content.substring(startIndex, i),\n      end: i,\n    };\n  }\n\n  public parseSelector(selector: string, isSilent?: boolean, isAggressiveMode?: boolean, id?: number, type?: RuleType): Selector[] | null {\n    if (selector.length === 0) {\n      return null;\n    }\n    // Check if the selector is an action operator\n    const matchedAction = ACTION_OPERATORS_REGEX.exec(selector);\n    if (matchedAction) {\n      return this.parseActionOperator(matchedAction);\n    }\n\n    // Check if the selector is a complex operator\n    const match = COMPLEX_OPERATORS_REGEX.exec(selector);\n    if (!match) {\n      return [\n        {\n          type: \"plain\",\n          selector: selector,\n          raw: selector,\n        },\n      ];\n    }\n\n    const selectors: Selector[] = [];\n    if (match.index > 0) {\n      selectors.push({\n        type: \"plain\",\n        selector: selector.substring(0, match.index),\n        raw: selector.substring(0, match.index),\n      });\n    }\n\n    const startIndex = match.index + match[0].length;\n    const content = this.parseSelectorContent(selector, startIndex);\n\n    if (!content) {\n      throw new SyntaxError(\n        `Failed to parse selector \"${selector}\" due to unmatched parentheses.`\n      );\n    }\n\n    switch (match[1]) {\n      case \"fmd5\":\n        // For fmd5, use only the hash without any chaining\n        // This returns the selector directly without parsing any additional parts\n        return [{\n          type: \"fmd5\",\n          ruleType: type,\n          hash: content.text,\n          raw: selector,\n          isSilent,\n          isAggressiveMode,\n          id\n        }];\n        // Don't process any further parts\n      case \"properties\":\n        selectors.push({\n          type: \"properties\",\n          propertyFilter: content.text,\n          raw: selector,\n        });\n        break;\n      case \"has\":\n        const hasSelectors = this.parseSelector(content.text);\n        if (hasSelectors === null) break;\n        selectors.push({\n          type: \"has\",\n          selectors: hasSelectors,\n          raw: selector,\n        });\n        break;\n\n      case \"contains\":\n        // Validate that :contains() is not used alone\n        if (selectors.length === 1 && selectors[0].type === \"contains\") {\n          throw new SyntaxError(\n            `Failed to parse selector \"${selector}\", can't have a lonely :contains().`\n          );\n        }\n\n        selectors.push({\n          type: \"contains\",\n          text: content.text,\n          raw: selector,\n        });\n        break;\n\n      case \"comments\":\n        // Validate that :comments() is not used alone\n        if (selectors.length === 1 && selectors[0].type === \"comments\") {\n          throw new SyntaxError(\n            `Failed to parse selector \"${selector}\", can't have a lonely :comments().`\n          );\n        }\n\n        selectors.push({\n          type: \"comments\",\n          text: content.text,\n          raw: selector,\n        });\n        break;\n\n      case \"xpath\":\n        selectors.push({\n          type: \"xpath\",\n          xpath: content.text,\n          raw: selector,\n        });\n        break;\n\n      case \"not\":\n        const notSelectors = this.parseSelector(content.text);\n        // If all inner selectors are plain, we can use native :not()\n        if (\n          notSelectors &&\n          Array.isArray(notSelectors) &&\n          notSelectors.every((s) => s.type === \"plain\")\n        ) {\n          selectors.push({\n            type: \"plain\",\n            selector: `:not(${content.text})`,\n            raw: selector,\n          });\n        } else if (notSelectors) {\n          selectors.push({\n            type: \"not\",\n            selectors: notSelectors,\n            raw: selector,\n          });\n        }\n        break;\n\n      default:\n        throw new SyntaxError(\n          `Failed to parse selector \"${selector}\", invalid pseudo-class :${match[1]}().`\n        );\n    }\n\n    // Parse the rest of the selector after the special pseudo-class\n    const rest = this.parseSelector(selector.substring(content.end + 1));\n    if (rest) {\n      selectors.push(...(Array.isArray(rest) ? rest : [rest]));\n    }\n    return selectors;\n  }\n\n  private parseActionOperator(matchedAction: RegExpExecArray): Selector[] {\n    const action = matchedAction![2];\n    const selector = matchedAction![1];\n    const raw = matchedAction.input;\n    return [\n      {\n        type: \"plain\",\n        action: action as Actions,\n        selector: selector,\n        raw,\n      },\n    ];\n  }\n}\n","export const RELOAD_ON_CLOSE_PORT = 'RELOAD_ON_CLOSE_PORT';\nexport const MSG_ICON_REFRESH = 'MSG_ICON_REFRESH';\nexport const MSG_ICONS_REFRESH = 'MSG_ICONS_REFRESH';\n\nexport const EXCLUSION_MALWARE = 'EXCLUSION_MALWARE';\nexport const EXCLUSION_SCAMS = 'EXCLUSION_SCAMS';\nexport const EXCLUSION_ADS = 'EXCLUSION_ADS';\nexport const EXCLUSION_PUPS = 'EXCLUSION_PUPS';\nexport const EXCLUSION_TYPE_DOMAIN = 'domain';\nexport const GDPR_REMOVAL_FLAG = 'GDPR_REMOVAL_FLAG';\nexport const EXCLUSION_TYPE_DOMAIN_TEMPORARY = 'domain (temporary)';\nexport const BAD_PACKAGE_ERROR = \"BAD_PACKAGE_ERROR\"\nexport const MSG_CHECK_PERMISSION = \"MSG_CHECK_PERMISSION\"\nexport const MISSING_DATABASE_ERROR = \"MISSING_DATABASE_ERROR\"\nexport const LICENSE_FREE = 'LICENSE_FREE';\nexport const LICENSE_TRIAL = 'LICENSE_TRIAL';\nexport const LICENSE_PREMIUM = 'LICENSE_PREMIUM';\nexport const LICENSE_STATE_ENUM = Object.freeze({\n    LicenseStateUnknown: 0,\n    LicenseStateFree: 1,\n    LicenseStateTrial: 2,\n    LicenseStateTrialExpired: 3,\n    LicenseStateLicensed: 4,\n    LicenseStateLicenseExpired: 5,\n    LicenseStateLicenseGrace: 6\n});\nexport const PREMIUM_LICENSE_STATES = Object.freeze([2, 4, 6]);\nexport const SETTING_TELEMETRY_CONSENT = 'sendTelemetry';\nexport const SETTING_ADS = 'enableProtectionAds';\nexport const SETTING_GTLD = 'enableProtectionGtld';\nexport const SETTING_NATIVE_MESSAGING = 'enableNativeMessaging';\nexport const SETTING_MALWARE = 'enableProtectionMalware';\nexport const SETTING_SCAMS = 'enableProtectionScams';\nexport const SETTING_BLOCK_COUNT = 'enableBlockCountDisplay';\nexport const SETTING_KILLSWITCH = 'enableProtection';\nexport const SETTING_SKIMMER_PROTECTION = 'enableSkimmerProtection';\nexport const SETTING_VERBOSE_LOGGING = 'enableVerboseLogging';\nexport const SETTING_MONTHLY_NOTIFICATION = 'enableMonthlyNotification';\nexport const SETTING_MALICIOUS_NOTIFICATION = 'enableMaliciousNotification';\nexport const SETTING_BREACH_NOTIFICATION = 'enableBreachNotification';\nexport const SETTING_NEW_RELEASE_NOTIFICATION = 'enableNewReleaseNotification';\nexport const SETTING_SEARCH_HIJACKING_NOTIFICATION = 'enableSearchHijackingNotification';\nexport const SETTING_VISUAL_DEBUGGING = 'enableVisualDebugging';\nexport const SETTING_PING_TRACKER_REMOVER = 'enablePingTrackerRemover';\n\nexport const SETTING_FLAGS = {\n    [SETTING_KILLSWITCH]: 0x00000002, // Overall Protection status\n    [SETTING_ADS]: 0x00000004, // Ads/Trackers\n    [SETTING_MALWARE]: 0x00000008, // Malware\n    [SETTING_SCAMS]: 0x00000010, // Scams\n};\nexport const ALLOWED_EXCLUSION_OPTIONS = [\n    {\n        value: 2,\n        constantKey: EXCLUSION_ADS,\n        humanReadable: \"Ads / Trackers\"\n    },\n    {\n        value: 4,\n        constantKey: EXCLUSION_MALWARE,\n        humanReadable: \"Malware\"\n    },\n    {\n        value: 6,\n        constantKey: EXCLUSION_SCAMS,\n        humanReadable: \"Scams\"\n    },\n    {\n        value: 7,\n        constantKey: EXCLUSION_PUPS,\n        //Do not display PUPs label anymore\n        humanReadable: \"\"\n    }\n];\n\nexport const RELEASE_NOTIFICATION_DEAFULT_TEXT = 'Browser Guard has been updated!';\n\n//Change manually these release notes \nexport const RELEASE_NOTIFICATION_NOTES_MV3 = [\n    'Prevent fingerprinting of this extension',\n    'Favicon md5 heuristic detection',\n    'Misc bug fixes' // this should always exist and be the last one.\n];\n\n\n// Feature flags that are enabled/disabled by the FEATURE_FLAGS DB\nexport const FLAG_ENABLE_BLOCK_EASYLIST_ADS = 'enableBlockEasylistAds';\nexport const FLAG_ENABLE_BLOCK_GDPR = 'enableBlockGdpr';\nexport const FLAG_ENABLE_BLOCK_LOCAL_PORT_SCANNING = 'enableBlockLocalPortScanning';\nexport const FLAG_ENABLE_BLOCK_YOUTUBE_CUSTOM_ADS = 'enableBlockYoutubeCustomAds';\nexport const FLAG_ENABLE_BREACH_NOTIFICATION = 'enableBreachNotification';\nexport const FLAG_ENABLE_SEARCH_HIJACKING_NOTIFICATION = 'enableSearchHijackingNotification';\nexport const FLAG_ENABLE_HEURISTIC_BLOCKING = 'enableHeuristicBlocking';\nexport const FLAG_ENABLE_SUSPICIOUS_POST_OR_PUT_DETECTION = 'enableSuspiciousPostOrPutDetection';\nexport const FLAG_ENABLE_SUSPICIOUS_TITLE_DETECTION = 'enableSuspiciousTitleDetection';\nexport const FLAG_ENABLE_PING_TRACKER_REMOVER = 'enablePingTrackerRemover';\n\nexport const FLAG_ENABLE_PREMIUM = 'FLAG_ENABLE_PREMIUM';\nexport const UPDATE_DB_MAX_ATTEMPS = 4;\n\nexport const MSG_FIREFOX = 'MSG_FIREFOX';\nexport const MSG_UUID_GET = 'MSG_UUID_GET';\nexport const MSG_INT_VER = 'MSG_INT_VER';\nexport const MSG_USER_GROUP_GET = 'MSG_USER_GROUP_GET';\nexport const MSG_IS_ONBOARDING_COMPLETE = 'MSG_IS_ONBOARDING_COMPLETE';\nexport const MSG_WEBSITE_CHECKBOX_GET = 'MSG_WEBSITE_CHECKBOX_GET';\nexport const MSG_SETTINGS_GET = 'MSG_SETTINGS_GET';\nexport const MSG_SETTINGS_SET = 'MSG_SETTINGS_SET';\nexport const MSG_IS_PREMIUM = 'MSG_IS_PREMIUM';\nexport const MSG_IS_TRIAL = 'MSG_IS_TRIAL';\nexport const MSG_TAB_DATA_GET = 'MSG_TAB_DATA_GET';\nexport const MSG_RECORDS_GET = 'MSG_RECORDS_GET';\nexport const MSG_GET_ALL_STATS = 'MSG_GET_ALL_STATS';\nexport const MSG_DEBUG_ADD_STATS = 'MSG_DEBUG_ADD_STATS';\nexport const MSG_DEBUG_CLEAR_STATS = 'MSG_DEBUG_CLEAR_STATS';\nexport const MSG_ADD_ALLOW = 'MSG_ADD_ALLOW';\nexport const MSG_SET_ALLOW_GRANULAR = 'MSG_SET_ALLOW_GRANULAR';\nexport const MSG_GET_ALLOW_GRANULAR = 'MSG_GET_ALLOW_GRANULAR';\nexport const MSG_ADD_ALLOW_TEMPORARY = 'MSG_ADD_ALLOW_TEMPORARY';\nexport const MSG_ALLOW_TEMPORARILY = 'MSG_ALLOW_TEMPORARILY';\nexport const MSG_ADD_ALLOW_META_ONLY = 'MSG_ADD_ALLOW_META_ONLY';\nexport const MSG_REM_ALLOW_ALL = 'MSG_REM_ALLOW_ALL';\nexport const MSG_REM_ALLOW_DOMAIN = 'MSG_REM_ALLOW_DOMAIN';\nexport const MSG_REM_ALLOW_SINGLE = 'MSG_REM_ALLOW_SINGLE';\nexport const MSG_ALLOW_GET_ALL = 'MSG_ALLOW_GET_ALL';\nexport const MSG_ALLOW_GET_SINGLE = 'MSG_ALLOW_GET_SINGLE';\nexport const MSG_IS_LAYER_ACTIVE = 'MSG_IS_LAYER_ACTIVE';\nexport const MSG_DOWNLOAD_LOGS = 'MSG_DOWNLOAD_LOGS';\nexport const MSG_FORCE_DATABASE_UPDATE = 'MSG_FORCE_DATABASE_UPDATE';\nexport const MSG_TAB_ID_GET = 'MSG_TAB_ID_GET';\nexport const MSG_TAB_INFO_GET = 'MSG_TAB_INFO_GET';\nexport const MSG_GET_HEURISTICS_DATABASE = \"MSG_GET_HEURISTICS_DATABASE\";\nexport const MSG_IS_NEEDING_NATIVE_MSG = 'MSG_IS_NEEDING_NATIVE_MSG';\nexport const MSG_TOGGLE_NATIVE_MSG = 'MSG_TOGGLE_NATIVE_MSG';\nexport const MSG_BADGE_COUNT_UPDATE = 'MSG_BADGE_COUNT_UPDATE';\nexport const MSG_RECORD_ARW = 'MSG_RECORD_ARW';\nexport const MSG_IS_AD_PROTECTION_ACTIVE = 'MSG_IS_AD_PROTECTION_ACTIVE';\nexport const MSG_GET_BLOCKED_ITEMS = 'MSG_GET_BLOCKED_ITEMS';\nexport const MSG_DELETE_BLOCKED_ITEM = 'MSG_DELETE_BLOCKED_ITEM';\nexport const MSG_DELETE_ALL_BLOCKED_ITEMS = 'MSG_DELETE_ALL_BLOCKED_ITEMS';\nexport const MSG_TELEMETRY_EMAIL_SHOWN = 'MSG_TELEMETRY_EMAIL_SHOWN';\nexport const MSG_TELEMETRY_EMAIL_SENT = 'MSG_TELEMETRY_EMAIL_SENT';\nexport const MSG_TELEMETRY_EMAIL_FAILED = 'MSG_TELEMETRY_EMAIL_FAILED';\nexport const MSG_MV3_LAST_TAB_URL = 'MSG_MV3_LAST_TAB_URL';\nexport const PORT_FORCE_DATABASE_UPDATE = 'PORT_FORCE_DATABASE_UPDATE';\nexport const GROUP_A = 'GROUP_A';\nexport const MSG_RESET = 'MSG_RESET';\nexport const MSG_RECORD_CONTENT_AD = 'MSG_RECORD_CONTENT_AD';\nexport const MSG_RECORD_EASYLIST_AD = 'MSG_RECORD_EASYLIST_AD';\nexport const MSG_RECORD_EASYLIST_PRIVACY = 'MSG_RECORD_EASYLIST_PRIVACY';\nexport const MSG_MV3_TOGGLE_PROTECTION = 'MSG_MV3_TOGGLE_PROTECTION';\nexport const MSG_MV3_TOGGLE_INDIVIDUAL_PROTECTION = 'MSG_MV3_TOGGLE_INDIVIDUAL_PROTECTION';\nexport const MSG_MV3_TOGGLE_GTLD_PROTECTION = 'MSG_MV3_TOGGLE_GTLD_PROTECTION';\nexport const MV3_PROTECTION_ADS = 'MV3_ADS';\nexport const MV3_PROTECTION_MALWARE = 'MV3_MALWARE';\nexport const MV3_PROTECTION_SCAMS = 'MV3_SCAMS';\nexport const SETTING_MV3_ENABLED_FEATURES = 'MV3_ENABLED_FEATURES';\nexport const MV3_FEATURE_ALL = 'MV3_FEATURE_ALL';\nexport const MV3_FEATURE_ADS_TRACKERS = 'ADS_TRACKERS';\nexport const MV3_FEATURE_EASYLIST = 'EASYLIST';\nexport const MV3_FEATURE_EASYLIST_PRIVACY = 'EASYLIST_PRIVACY';\nexport const MV3_FEATURE_MALWARE = 'MALWARE';\nexport const MV3_FEATURE_MONTHLY_NOTIFICATIONS = 'MONTHLY_NOTIFICATIONS ';\nexport const MV3_FEATURE_MALICIOUS_NOTIFICATIONS = 'MALICIOUS_NOTIFICATIONS';\nexport const MV3_FEATURE_NEW_RELEASE_NOTIFICATIONS = 'NEW_RELEASE_NOTIFICATIONS';\nexport const MV3_FEATURE_BREACH_NOTIFICATIONS = 'BREACH_NOTIFICATIONS';\nexport const MV3_FEATURE_SEARCH_HIJACKING_NOTIFICATIONS = 'SEARCH_HIJACKING_NOTIFICATIONS';\nexport const MSG_BREACH_NOTIFICATION = 'MSG_BREACH_NOTIFICATION';\nexport const MSG_MV3_INIT_WITH_IDS = 'MSG_MV3_INIT_WITH_IDS';\nexport const MSG_MV3_POST_NATIVE_EXCLUSION = 'MSG_MV3_POST_NATIVE_EXCLUSION';\nexport const MSG_INFO_BLOCKED_CONTENT = 'MSG_INFO_BLOCKED_CONTENT';\nexport const MSG_INFO_BLOCKED_CONTENT_DISPLAYED = 'MSG_INFO_BLOCKED_CONTENT_DISPLAYED';\nexport const MSG_INFO_BREACH_NOTIFICATION_DISPLAYED = 'MSG_INFO_BREACH_NOTIFICATION_DISPLAYED';\nexport const MSG_INFO_MONTHLY_NOTIFICATION = 'MSG_INFO_MONTHLY_NOTIFICATION';\nexport const MSG_INFO_RELEASE_NOTIFICATION = 'MSG_INFO_RELEASE_NOTIFICATION';\nexport const MSG_TOGGLE_VERBOSE_LOGGING = 'MSG_TOGGLE_VERBOSE_LOGGING';\nexport const MSG_CONTENT_CONTROL_GET_ALL = 'MSG_CONTENT_CONTROL_GET_ALL';\nexport const MSG_CONTENT_CONTROL_REMOVE_ITEM = 'MSG_CONTENT_CONTROL_REMOVE_ITEM';\nexport const MSG_CONTENT_CONTROL_ADD_ITEM = 'MSG_CONTENT_CONTROL_ADD_ITEM';\nexport const MSG_CONTENT_CONTROL_REMOVE_ALL = 'MSG_CONTENT_CONTROL_REMOVE_ALL';\nexport const MSG_DETECTION_HISTORY_GET_ALL = 'MSG_DETECTION_HISTORY_GET_ALL';\nexport const MSG_DETECTION_HISTORY_ADD_ITEM = 'MSG_DETECTION_HISTORY_ADD_ITEM';\nexport const MSG_DETECTION_HISTORY_REMOVE_ALL = 'MSG_DETECTION_HISTORY_REMOVE_ALL';\nexport const MSG_DETECTION_HISTORY_REMOVE_ITEM = 'MSG_DETECTION_HISTORY_REMOVE_ITEM';\nexport const MSG_IS_NEW_FEATURE_SEEN = 'MSG_IS_NEW_FEATURE_SEEN';\nexport const MSG_MARK_NEW_FEATURE_SEEN = 'MSG_MARK_NEW_FEATURE_SEEN';\nexport const FEAT_CONTENT_CONTROLS = 'contentControls';\nexport const FEAT_EXPORT_IMPORT = 'exportImport';\nexport const MSG_EXPORT_SETTINGS = 'MSG_EXPORT_SETTINGS';\nexport const MSG_IMPORT_SETTINGS = 'MSG_IMPORT_SETTINGS';\nexport const MSG_IS_WHITELISTED_SCAM = 'MSG_IS_WHITELISTED_SCAM';\nexport const MSG_DEBUG_TEST_CHANNEL = 'MSG_DEBUG_TEST_CHANNEL';\nexport const MSG_DEBUG_CHECK_URL = 'MSG_DEBUG_CHECK_URL';\nexport const MSG_DEBUG_ADD_HEURISTIC_RULE = 'MSG_DEBUG_ADD_HEURISTIC_RULE';\nexport const MSG_DEBUG_STAGING_CHANNEL = 'MSG_DEBUG_STAGING_CHANNEL';\nexport const MSG_DEBUG_STAGING_CHANNEL_RESPONSE = 'MSG_DEBUG_STAGING_CHANNEL_RESPONSE';\nexport const MSG_DEBUG_UPDATE_ERROR = 'MSG_DEBUG_UPDATE_ERROR';\nexport const MSG_COLOR_SCHEME_CHANGED = 'MSG_COLOR_SCHEME_CHANGED';\nexport const MSG_QUERY_FEATURE_FLAG = 'MSG_QUERY_FEATURE_FLAG';\nexport const MSG_LOAD_INLINE_SCRIPT = 'MSG_LOAD_INLINE_SCRIPT';\nexport const MSG_GET_EASYLIST_SELECTORS = 'MSG_GET_EASYLIST_SELECTORS';\nexport const MSG_GET_HEURISTICS_URLS_TO_BLOCK = 'MSG_GET_HEURISTICS_URLS_TO_BLOCK';\nexport const MSG_QUERY_EASYLIST = 'MSG_QUERY_EASYLIST';\nexport const MSG_IS_EXCLUDED = \"isExcluded\";\nexport const MSG_DETECTION = \"detection\";\nexport const MSG_TELEMETRY_PHISHING_TUNNEL = \"telemetryPhishingTunnel\";\nexport const MSG_CONTEXT_MENU_TARGET_URLS = \"context-menu-target-urls\";\nexport const MSG_UPDATE_PROTECTION_ON_PERM_CHANGE = \"MSG_UPDATE_PROTECTION_ON_PERM_CHANGE\";\nexport const SHOW_PERMISSION_REQUEST_ALARM = \"showPermissionRequestAlarm\";\nexport const IS_URL_PERM_REMOVED_FLAG = \"IS_URL_PERM_REMOVED_FLAG\";\nexport const MSG_CLOSE_POPUP = \"MSG_CLOSE_POPUP\";\nexport const MSG_RECORD_PING_TRACKER_REMOVAL = \"MSG_RECORD_PING_TRACKER_REMOVAL\";\nexport const MSG_CHECK_ALLOW_LIST_BY_TYPE_AND_DOMAIN = 'MSG_CHECK_ALLOW_LIST_BY_TYPE_AND_DOMAIN';\nexport const MSG_CHECK_DOMAIN_ALLOW_LIST_RESPONSE = 'MSG_CHECK_DOMAIN_ALLOW_LIST_RESPONSE';\nexport const MSG_CHECK_DOMAIN_ALLOW_LIST = 'MSG_CHECK_DOMAIN_ALLOW_LIST';\nexport const MSG_APPEND_CONSOLE_LOG = \"MSG_APPEND_CONSOLE_LOG\";\nexport const MSG_TEST_MY_ACCOUNT_RESPONSE = 'MSG_TEST_MY_ACCOUNT_RESPONSE';\nexport const MSG_TEST_FP_CHECKER = 'MSG_TEST_FP_CHECKER';\nexport const RecordType = {\n    AD: 'AD',\n    MALWARE: 'MALWARE',\n    SCAM: 'SCAM',\n    CONTENT: 'CONTENT',\n};\nexport const ATTRIBUTION_REPORTING = 'googleattributionreport';\nexport const HEURISTIC_AD_BLOCK = 'heuristic-ad-block';\nexport const EASYLIST_AD_BLOCK = 'easylist-ad-block';\nexport const EASYLIST_PRIVACY_BLOCK = 'easylist-privacy-block';\nexport const MSG_IS_ATTR_REPORTING_ACTIVE = 'MSG_IS_ATTR_REPORTING_ACTIVE';\nexport const MSG_IS_PING_TRACKER_REMOVER_ACTIVE = 'MSG_IS_PING_TRACKER_REMOVER_ACTIVE';\nexport const PERM_LAST_DISPLAYED_MEMORY_VAR = 'permNotificationLastDisplayed';\nexport const PING_TRACKER = 'pingtracker';\n\n\n\n/*      RESOURCE PATHES     */\nexport const RESOURCE_CONTENT_STYLE = \"app/content-style.css\";\n\n\n/*      CSS CLASSES     */\nexport const CSS_DISPLAY_NONE = 'A2O4W8X6IK';\nexport const CSS_DISPLAY_VISUAL_DEBUGGING_EL_GENERIC = 'B2O4W8X6IL'; // easylist visual debugging generic items\nexport const CSS_DISPLAY_VISUAL_DEBUGGING_EL_SPECIFIC = 'C2O4W8X6IM'; // easylist visual debugging site specific items\nexport const CSS_DISPLAY_VISUAL_DEBUGGING_HE = 'D2O4W8X6IN'; // heuristics visual debugging\nexport const CSS_GLOBAL_NOTIFICATION = 'mb-global-notification';\nexport const CSS_NOTIFICATION_INFO = 'mb-global-info';\nexport const CSS_NOTIFICATION_WARNING = 'mb-global-warning';\n\nexport const THREAT_TYPES = Object.freeze({\n    MALWARE: Object.freeze({\n        type: 'malware',\n        FULL_URL_MALWARE: 'full-url-malware',\n        SUSPICIOUS_PAGE: 'suspiciousPage',\n        SUSPICIOUS_TLD: 'suspiciousTLD',\n        RISKY_PATTERN: 'riskyPattern',\n        SUSPICIOUS_CONTENT: 'suspiciousContent',\n        MALWARE_PATTERN: 'malware-pattern',\n        ALERT_LOOP: 'alertLoop',\n        AUTH_REQUIRED_LOOP: 'authRequiredLoop',\n        CREATE_URL_LOOP: 'createURLLoop',\n        EXTENSION_INSTALL: 'extensionInstall',\n        FULL_SCREEN_LOOP: 'fullScreenLoop',\n        HISTORY_LOOP: 'historyLoop',\n        NOTIFICATION_LOOP: 'notificationLoop',\n        PRINT_LOOP: 'printLoop',\n        ADWARE: 'adware',\n        REPUTATION: 'reputation',\n        TROJAN: 'trojan',\n        MALVERTISING: 'malvertising',\n        WORM: 'worm',\n        RANSOMWARE: 'ransomware',\n        ROOTKIT: 'rootkit',\n        BACKDOOR: 'backdoor',\n        SPYWARE: 'spyware',\n        ALLOWED_EXCLUSION_VALUE: 4,\n    }),\n    SCAM: Object.freeze({\n        type: 'scam',\n        TSS: 'tss',\n        SCAM_HEURISTIC: 'scam_heuristic',\n        ALLOWED_EXCLUSION_VALUE: 6,\n\n    }),\n    PHISHING: Object.freeze({\n        type: 'phishing',\n        PHISHING_SUSPICIOUS_POST: 'phishing_suspicious_post',\n        PHISHING_BANKING: 'phishing_banking',\n        PHISHING_LOGIN: 'phishing_login',\n        PHISHING_LOGIN_VIA_TUNNEL: 'phishing_login_via_tunnel',\n        TELEMETRY_PHISHING_TUNNEL: 'telemetryPhishingTunnel',\n    }),\n    AD: Object.freeze({\n        type: 'ad',\n        ADSERVER: 'adserver',\n        ALLOWED_EXCLUSION_VALUE: 2,\n    }),\n    ADS: Object.freeze({\n        type: 'ads',\n        ADSERVER: 'adserver',\n        ALLOWED_EXCLUSION_VALUE: 2,\n    }),\n});\n\nexport const BROWSERS = Object.freeze({\n    CHROME: 'Chrome',\n    FIREFOX: 'Firefox',\n    OPERA: 'Opera',\n    EDGE: 'Edge',\n    SAFARI: 'Safari',\n});\n\nexport const DEFAULT_PERMISSIONS = Object.freeze({\n    origins: [\"<all_urls>\"],\n    permissions: [], // All permissions - to be filled.\n    optional_permissions: [] // All optional permissions - to be filled.\n});\n\n/*      ALLOWED EXPORTED SETTINGS     */\nexport const ALLOWED_EXPORTED_SETTINGS = {\n    version: \"3.0.0\",\n    allowList: {},\n    blockedItems: [],\n    contentControls: [],\n    settings: {\n        enableBlockCountDisplay: true,\n        enableMaliciousNotification: true,\n        enableMonthlyNotification: true,\n        enableNewReleaseNotification: true,\n        enableProtection: true,\n        enableProtectionAds: true,\n        enableProtectionMalware: true,\n        enableProtectionScams: true,\n        enableSkimmerProtection: true,\n        showReleaseNotificationFlag: true,\n        enableProtectionGtld: false,\n        enableVerboseLogging: false,\n    }\n}\n\n/*\n    Standard CSS selectors, the separator is ##.\n    Extended CSS pseudo-selectors, the separator is #?#.\n */\n\nexport const ruleSeparatorRegex = /^(.*?)(##|#\\?#)(.+)$/\nexport const ruleSeparatorRegexInstance = new RegExp(ruleSeparatorRegex)\n\nexport const BROWSER_PERMISSIONS = Object.freeze({\n    Chrome: Object.freeze({\n        origins: [],\n        permissions: [ // this inlcudes all permissions, required and optional\n            \"alarms\",\n            \"downloads\",\n            \"storage\",\n            \"tabs\",\n            \"declarativeNetRequest\",\n            \"declarativeNetRequestFeedback\",\n            \"unlimitedStorage\",\n            \"webRequest\",\n            \"contextMenus\",\n            \"nativeMessaging\",\n            \"offscreen\",\n            \"activeTab\",\n            \"clipboardRead\",\n            \"clipboardWrite\"\n        ]\n    }),\n    Firefox: Object.freeze({\n        origins: [],\n        permissions: [ // this inlcudes all permissions, required and optional\n            \"alarms\",\n            \"downloads\",\n            \"storage\",\n            \"tabs\",\n            \"declarativeNetRequest\",\n            \"declarativeNetRequestFeedback\",\n            \"unlimitedStorage\",\n            \"webRequest\",\n            \"webRequestBlocking\",\n            \"contextMenus\",\n            \"nativeMessaging\",\n            \"activeTab\",\n            \"clipboardRead\",\n            \"clipboardWrite\"\n        ]\n    }),\n    Edge: Object.freeze({\n        origins: [],\n        permissions: [ // this inlcudes all permissions, required and optional\n            \"alarms\",\n            \"downloads\",\n            \"nativeMessaging\",\n            \"storage\",\n            \"tabs\",\n            \"webRequest\",\n            \"declarativeNetRequest\",\n            \"declarativeNetRequestFeedback\",\n            \"unlimitedStorage\",\n            \"contextMenus\",\n            \"offscreen\",\n            \"clipboardRead\",\n            \"clipboardWrite\"\n        ]\n    }),\n    Safari: Object.freeze({\n        origins: [],\n        permissions: []\n    })\n});\n\n\n// the pruposse of this object is to have a human readable title and description for each permission\nexport const PERMISSIONS_CONTROL_CAROUSEL = Object.freeze({\n    clipboardRead: {\n        title: \"clipboardReadPermTitle\",\n        description: \"clipboardReadPermDesc\"\n    },\n    clipboardWrite: {\n        title: \"clipboardWritePermTitle\",\n        description: \"clipboardWritePermDesc\"\n    },\n    alarms: {\n        title: \"alarms\",\n        description: \"alarms\"\n    },\n    downloads: {\n        title: \"downloads\",\n        description: \"downloads\"\n    },\n    storage: {\n        title: \"storage\",\n        description: \"storage\"\n    },\n    tabs: {\n        title: \"tabs\",\n        description: \"tabs\"\n    },\n    declarativeNetRequest: {\n        title: \"declarativeNetRequest\",\n        description: \"declarativeNetRequest\"\n    },\n    declarativeNetRequestFeedback: {\n        title: \"declarativeNetRequestFeedback\",\n        description: \"declarativeNetRequestFeedback\"\n    },\n    unlimitedStorage: {\n        title: \"unlimitedStorage\",\n        description: \"unlimitedStorage\"\n    },\n    webRequest: {\n        title: \"webRequest\",\n        description: \"webRequest\"\n    },\n    contextMenus: {\n        title: \"contextMenus\",\n        description: \"contextMenus\"\n    },\n    nativeMessaging: {\n        title: \"nativeMessaging\",\n        description: \"nativeMessaging\"\n    },\n    offscreen: {\n        title: \"offscreen\",\n        description: \"offscreen\"\n    },\n    activeTab: {\n        title: \"activeTab\",\n        description: \"activeTab\"\n    },\n});\n\n// List of domains that are always allowed, even if Research deliberate tries to block them.\nexport const ALWAYS_ALLOW = {\n    'amazon.com': true, 'www.amazon.com': true,\n    'baidu.com': true, 'www.baidu.com': true,\n    'bilibili.com': true, 'www.bilibili.com': true,\n    'bing.com': true, 'www.bing.com': true,\n    'cnn.com': true, 'www.cnn.com': true,\n    'discord.com': true, 'www.discord.com': true,\n    'discordapp.com': true, 'www.discordapp.com': true,\n    'ebay.com': true, 'www.ebay.com': true,\n    'facebook.com': true, 'www.facebook.com': true,\n    'foxnews.com': true, 'www.foxnews.com': true,\n    'google.com': true, 'www.google.com': true,\n    'instagram.com': true, 'www.instagram.com': true,\n    'linkedin.com': true, 'www.linkedin.com': true,\n    'live.com': true, 'www.live.com': true,\n    'mail.ru': true, 'www.mail.ru': true,\n    'malwarebytes.com': true, 'www.malwarebytes.com': true,\n    'mbamupdates.com': true, 'www.mbamupdates.com': true,\n    'microsoft.com': true, 'www.microsoft.com': true,\n    'microsoftonline.com': true, 'www.microsoftonline.com': true,\n    'mozilla.com': true, 'www.mozilla.com': true,\n    'msn.com': true, 'www.msn.com': true,\n    'mwbsys.com': true, 'www.mwbsys.com': true, // Malwarebytes CDN\n    'naver.com': true, 'www.naver.com': true,\n    'netflix.com': true, 'www.netflix.com': true,\n    'nsslabs.com': true, 'www.nsslabs.com': true,\n    'office.com': true, 'www.office.com': true,\n    'pinterest.com': true, 'www.pinterest.com': true,\n    'qq.com': true, 'www.qq.com': true,\n    'reddit.com': true, 'www.reddit.com': true,\n    'tiktok.com': true, 'www.tiktok.com': true,\n    'twitch.tv': true, 'www.twitch.tv': true,\n    'twitter.com': true, 'www.twitter.com': true,\n    'virustotal.com': true, 'www.virustotal.com': true,\n    'vk.com': true, 'www.vk.com': true,\n    'weather.com': true, 'www.weather.com': true,\n    'whatsapp.com': true, 'www.whatsapp.com': true,\n    'wikipedia.org': true, 'www.wikipedia.org': true,\n    'windows.net': true, 'www.windows.net': true,\n    'windowsupdate.com': true, 'www.windowsupdate.com': true,\n    'yahoo.co.jp': true, 'www.yahoo.co.jp': true,\n    'yahoo.com': true, 'www.yahoo.com': true,\n    'yandex.ru': true, 'www.yandex.ru': true,\n    'youtube.com': true, 'www.youtube.com': true,\n    'zoom.us': true, 'www.zoom.us': true,\n};\n\nexport const ALL_TIME_STATS_TEMPLATE = {\n    ads: 0,\n    silentAds: 0,\n    malwares: 0,\n    silentMalwares: 0,\n    scams: 0,\n    silentScams: 0,\n    content: 0,\n    silentContent: 0,\n}\n","import {\n  Actions,\n  BlockURL,\n  ContainsSelector,\n  CommentsSelector,\n  DomainRules,\n  ElementHidingSelectors,\n  FaviconMd5Selector,\n  HasSelector,\n  HeuristicRule,\n  HeuristicsRulesParams,\n  NotSelector,\n  ProcessedRules,\n  PropertiesSelector,\n  RuleType,\n  Selector,\n  SelectorObj,\n  XPathSelector,\n} from \"@/content-scripts/heuristics-db/types\";\nimport { SelectorParser } from \"@/content-scripts/heuristics-db/selector-parser\";\nimport { getFaviconHash } from \"@/utils/favicon-utils\";\n\nimport {\n  MSG_GET_HEURISTICS_DATABASE,\n  MSG_GET_HEURISTICS_URLS_TO_BLOCK,\n  ruleSeparatorRegexInstance,\n} from \"@/app/scripts/app-consts\";\nexport let useLogging = false;\n\n//@ts-ignore\nif (ENVIRONMENT == \"development\" && typeof window !== \"undefined\") {\n  useLogging = true;\n}\n\nexport const heuristicsElementsToRemove = new Set<Element>();\nexport const heuristicsUrlsToBlock = new Set<BlockURL>();\n\nexport const downloadHeuristicsDB = (): Promise<ProcessedRules | {}> =>\n  new Promise((resolve, reject) => {\n    chrome.runtime.sendMessage(\n      {\n        type: MSG_GET_HEURISTICS_DATABASE,\n        parameters: {\n          domain: window.location.hostname,\n          url: window.location.href,\n        }\n      },\n      resolve\n    );\n  });\n\nexport const sendHeuristicsURLsToBlock = (): Promise<ProcessedRules | string> =>\n  new Promise((resolve, reject) => {\n    if (heuristicsUrlsToBlock.size > 0) {\n      chrome.runtime.sendMessage(\n        {\n          type: MSG_GET_HEURISTICS_URLS_TO_BLOCK,\n          heuristicsUrlsToBlockArray: Array.from(heuristicsUrlsToBlock),\n        },\n        resolve\n      );\n    } else {\n      resolve(\"Nothing to block\");\n    }\n  });\n\nexport const processHeuristicsRules = async (\n  processedRules: ProcessedRules | {},\n  currentUrl: string\n) => {\n  const isEmpty = (o) => !o || Object.keys(o).length === 0;\n  const currentDomain = new URL(currentUrl).hostname;\n  const parser = new SelectorParser();\n\n  Object.entries(processedRules).forEach(([type, rules]) => {\n    if (isEmpty(rules)) return;\n\n    switch (type as RuleType) {\n      case RuleType.ADSERVER:\n      case RuleType.PHISHING:\n      case RuleType.SCAM:\n        const isPageBlock = [RuleType.SCAM, RuleType.PHISHING].includes(\n          type as RuleType\n        );\n\n        Object.entries(rules as DomainRules).forEach(\n          ([selectorsType, selectorsByDomain]) => {\n            if (\n              ![\n                ElementHidingSelectors[\"#?#\"],\n                ElementHidingSelectors[\"##\"],\n              ].includes(selectorsType as ElementHidingSelectors)\n            ) {\n              useLogging &&\n                console.warn(\n                  \"processHeuristicsRules:Unexpected selectorsType:\",\n                  selectorsType\n                );\n              return null;\n            }\n\n            let selector, isSilent, isAggressiveMode, id;\n            processSelectorsByDomain(selectorsByDomain, currentUrl).forEach(\n              (selectorArrays) => {\n                selectorArrays.forEach(async (selectors) => {\n                  let allSelectorsMatched = true; // a rule can have multiple selectors we block a page only if all selectors are matched\n                  for (let i = 0; i < selectors.length; i++) {\n                    const aSelector = selectors[i];\n                    // destructure the item\n                    selector = aSelector.selector;\n                    isSilent = aSelector.isSilent;\n                    isAggressiveMode = aSelector.isAggressiveMode;\n                    id = aSelector.id;\n                    try {\n                      const parsedSelectors = parser.parseSelector(selector, isSilent, isAggressiveMode, id, type as RuleType);\n                      if (!parsedSelectors) {\n                        allSelectorsMatched = false;\n                        return;\n                      };\n\n                      const elements = getElementsByRule(parsedSelectors);\n                      if (elements.length === 0) {\n                        allSelectorsMatched = false;\n                        return;\n                      }\n\n                      if (!isPageBlock) {\n                        elements.forEach((element) =>\n                          heuristicsElementsToRemove.add(element)\n                        );\n                      }\n                    } catch (error) {\n                      useLogging &&\n                        console.error(\"processSelectorsByDomain\", error);\n                      throw error;\n                    }\n                  } //\n                  if (allSelectorsMatched && isPageBlock) {\n                    heuristicsUrlsToBlock.add({\n                      domain: currentDomain,\n                      isSilent: isSilent || false,\n                      isAggressiveMode: isAggressiveMode || false,\n                      type: type as RuleType,\n                      source: selector,\n                      id: id,\n                    });\n                  }\n\n                });\n              }\n            );\n          }\n        );\n        break;\n      default:\n        return;\n    }\n  });\n};\n\ntype PatternInput = string | RegExp;\n\nexport const checkUrlAgainstCurrentDomain = (\n  pattern: PatternInput,\n  href: string | undefined\n): boolean => {\n  try {\n    if (!href) return false;\n    const urlRegex = new RegExp(pattern, \"i\");\n    return urlRegex.test(href);\n  } catch {\n    if (typeof pattern === \"string\" && href) {\n      return pattern === \"\" || pattern === \"*\" || href.includes(pattern);\n    }\n    return false;\n  }\n};\n\nexport function processSelectorsByDomain(\n  selectorsByDomain: SelectorObj[],\n  href: string\n): SelectorObj[][][] {\n  let parsedSelectorsToReturn: SelectorObj[][][] = [];\n  Object.entries(selectorsByDomain).forEach(([domainRegex, selectors]) => {\n    const applyForDomain = checkUrlAgainstCurrentDomain(domainRegex, href);\n    if (Array.isArray(selectors) && selectors.length > 0 && applyForDomain) {\n      parsedSelectorsToReturn.push(selectors);\n    }\n  });\n  return parsedSelectorsToReturn;\n}\n\n/**\n * Processes heuristic rules for ads, scams, and phishing\n * @param heuristicsContent Array of heuristic rules to process\n * @returns Processed rules organized by type and domain\n */\nexport async function processHeuristics(\n  heuristicsContent: HeuristicRule[]\n): Promise<ProcessedRules> {\n  const processedRules: ProcessedRules = {\n    adserver: {},\n    whitelist: {},\n    scam: {},\n    phishing: {},\n    action: [],\n    title: [],\n    description: [],\n    cleanName: \"heuristics\",\n    version: \"3.0.0\",\n    name: \"mbgc.db.heuristics.json.2\",\n  };\n\n  // Process each rule\n  for (const rule of heuristicsContent) {\n    if (!isValidHeuristicsRule(rule)) continue;\n    const {\n      r: ruleContent,\n      s: isSilent,\n      t: type,\n      a: isAggressiveMode,\n      id,\n    } = rule;\n    if (!ruleContent || !type) continue;\n\n    const params: HeuristicsRulesParams = {\n      isSilent,\n      isAggressiveMode: isAggressiveMode || false,\n      id,\n    };\n\n    switch (type) {\n      case RuleType.ADSERVER:\n        processRule(ruleContent, processedRules.adserver);\n        break;\n      case RuleType.SCAM:\n        processRule(ruleContent, processedRules.scam, params);\n        break;\n      case RuleType.PHISHING:\n        processRule(ruleContent, processedRules.phishing, params);\n        break;\n    }\n  }\n  return processedRules;\n}\n\ntype SimpleRule = {\n  separator: string;\n  selector: string;\n};\n\ntype RuleComponents = {\n  domain: string;\n  selectors: SimpleRule[];\n};\n\n/*\n * Splits a rule string into its components\n * @param rule - The rule string to split\n * @returns An object containing the domain, separator, and selectors\n * {\"id\": 5555, \"r\":\"#?#title:contains(Document)#@#h2:contains(bitcoin)\", \"s\":false, \"t\":\"phishing\", \"a\": true}\n */\nconst splitRule = (rule: string): RuleComponents | null => {\n  // split multiple rules by the separator #@#\n  const rules = rule.split(/#@#/);\n  // acquire rule separator from the first rule only\n  let firstRule = true;\n  let separator = \"\";\n  let ruleSelector = \"\";\n  let domain = \"\";\n  let result: RuleComponents = {\n    domain: \"\",\n    selectors: [],\n  };\n  for (const rule of rules) {\n    if (firstRule) {\n      const match = rule.match(ruleSeparatorRegexInstance);\n      if (!match) {\n        useLogging && console.debug(\"SR: Error splitRule: \", rule);\n        return null;\n      }\n      if (match) {\n        domain = match[1];\n        separator = match[2];\n        ruleSelector = match[3];\n        firstRule = false;\n        result = {\n          domain,\n          selectors: [\n            {\n              separator,\n              selector: ruleSelector,\n            },\n          ],\n        };\n      }\n    } else {\n      ruleSelector = rule;\n      result.selectors.push({\n        separator,\n        selector: ruleSelector,\n      });\n    }\n  }\n  return result;\n};\n\n/**\n * Process an individual ad rule and add it to the domain rules\n */\nfunction processRule(\n  ruleContent: string,\n  rules: DomainRules,\n  restParams?: HeuristicsRulesParams\n): void {\n  const dissectedRules: RuleComponents | null = splitRule(ruleContent);\n\n  if (!dissectedRules) {\n    useLogging && console.debug(\"PR: Error splitRule: \", ruleContent);\n    return;\n  }\n\n  let { domain, selectors } = dissectedRules;\n  if (!selectors || selectors.length === 0) {\n    useLogging && console.debug(\"PR: Error rulesArray: \", ruleContent);\n    return;\n  }\n\n  domain = domain.trim();\n  if (domain == \"\") domain = \"*\";\n  let processedSelectors: SelectorObj[] = [];\n  let separatorStr = \"\";\n  for (const item of selectors) {\n    separatorStr = ElementHidingSelectors[item.separator];\n    rules[separatorStr] = rules[separatorStr] || {};\n\n    // Process domain-specific rules\n    // {\"id\": 5555, \"r\":\"#?#title:contains(Document)#@#h2:contains(bitcoin)\", \"s\":false, \"t\":\"phishing\", \"a\": true}\n    rules[separatorStr][domain] = rules[separatorStr][domain] || [];\n    let aSelector = item.selector.trim();\n    // replace all pipe signs | with [|], since RegExp(\"Home | My Site\") matches \"Home\" or \"My Site\" thus giving false positives\n    if (aSelector.includes(\"\\\\|\")) {\n      aSelector = aSelector.replace(/\\\\\\|/g, \"[|]\");\n    }\n    if (aSelector.includes('\\\\\"')) {\n      aSelector = aSelector.replace(/\\\\\\\"/g, '\"');\n    }\n    processedSelectors.push({\n      selector: aSelector,\n      isSilent: restParams?.isSilent || false,\n      isAggressiveMode: restParams?.isAggressiveMode || false,\n      id: restParams?.id || 0,\n    });\n  }\n  rules[separatorStr][domain].push(processedSelectors);\n}\n\n/**\n * Validates if a heuristic rule has the required properties\n */\nconst isValidHeuristicsRule = (rule: unknown): rule is HeuristicRule => {\n  if (!rule || typeof rule !== \"object\") {\n    return false;\n  }\n\n  const typedRule = rule as Record<string, unknown>;\n\n  return (\n    typeof typedRule.r === \"string\" &&\n    (typeof typedRule.s === \"boolean\" || typedRule.s === null) &&\n    typeof typedRule.t === \"string\" &&\n    isValidRuleType(typedRule.t)\n  );\n};\n\n// Type guard for rule type\nconst isValidRuleType = (type: unknown): type is RuleType =>\n  typeof type === \"string\" && [\"adserver\", \"scam\", \"phishing\"].includes(type);\n\n/**\n * Gets DOM elements matching a specific rule set\n * @param rules Array of selector rules to process\n * @returns Array of matching DOM elements\n */\nexport const getElementsByRule = (rules: Selector[] | null): Element[] => {\n  let elements: Element[] = [];\n  let isFirstRule = true;\n\n  if (rules == null) return elements;\n  for (const rule of rules) {\n    if (isFirstRule) {\n      elements = processInitialSimpleSelectors(rule);\n      isFirstRule = false;\n    } else {\n      try {\n        elements = filterElementsByRule(elements, rule);\n      } catch (error) {\n        useLogging && console.error(\"Error filtering elements by rule\", error, rule);\n      }\n    }\n    // If no elements match at any point, we can stop processing\n    if (elements.length === 0) {\n      break;\n    }\n  }\n\n  return elements;\n};\n\n/**\n * Perform the specified action on elements matching the selector\n * @param selector - The CSS selector to match elements\n * @param action - The action to perform on matched elements\n */\nconst performActionOnElements = (selector: string, action: Actions) => {\n  Array.from(document.querySelectorAll(selector)).forEach((element) => {\n    switch (action) {\n      case Actions.CLICK_ON_ELEMENT:\n        if (element instanceof HTMLElement) {\n          element.click();\n        }\n        break;\n      case Actions.REMOVE_ELEMENT:\n        element.remove();\n        break;\n    }\n  });\n};\n/**\n * Process initial simple selectors and return matching elements\n * @param rule - The selector rule to process\n * @returns Array of matching DOM elements\n */\n\nconst processInitialSimpleSelectors = (rule: Selector): Element[] => {\n  switch (rule.type) {\n    case \"plain\":\n      if (typeof document !== \"undefined\") {\n        if (rule.action) {\n          performActionOnElements(rule.selector, rule.action);\n          return [];\n        }\n        if (rule.selector.startsWith(\"/\") && rule.selector.endsWith(\"/\")) {\n          const regex = new RegExp(rule.selector.slice(1, -1), \"i\");\n          return Array.from(document.querySelectorAll(\"*\")).filter((element) =>\n            regex.test(element.textContent ?? \"\")\n          );\n        }\n        let result = [];\n        try {\n          result = Array.from(document.querySelectorAll(rule.selector));\n        } catch (error) {\n          useLogging && console.error(\"Error in querySelectorAll\", error);\n          const prev = document.querySelector(\"#errors-preview\");\n          if (prev) {\n            prev.textContent = `Error in querySelectorAll: ${error}`;\n          }\n        }\n        return result;\n      } else {\n        useLogging && console.log(\"DEBUG:document undefined\");\n        return [];\n      }\n    case \"contains\":\n      return [];\n    case \"xpath\":\n      return evaluateXPathSelector(rule);\n    case \"fmd5\":\n      // For fmd5, we return an empty array since it is handled separately\n      // This avoids using an invalid selector with querySelectorAll\n      // faviconDetector(rule);\n      return [];\n    default:\n      useLogging &&\n        console.warn(`Unexpected initial selector type: ${rule.type}`);\n      return [];\n  }\n};\n\nconst filterElementsByRule = (\n  elements: Element[],\n  rule: Selector\n): Element[] => {\n  switch (rule.type) {\n    case \"plain\":\n      return elements.filter((element) => element.matches(rule.selector));\n    case \"contains\":\n      return filterByContains(elements, rule);\n    case \"comments\":\n      return filterByComments(rule);\n    case \"has\":\n      return filterByHas(elements, rule);\n    case \"not\":\n      return filterByNot(elements, rule);\n    case \"properties\":\n      return filterByProperties(elements, rule);\n    case \"xpath\":\n      return filterByXPath(elements, rule);\n    case \"fmd5\":\n      // Directly evaluate favicon MD5 for standalone rules\n      // No need to filter elements since fmd5 is standalone\n      // faviconDetector(rule);\n      return []; // Return empty array since fmd5 is handled separately\n    default:\n      useLogging &&\n        console.warn(`Unknown selector type: ${(rule as Selector).type}`);\n      return elements;\n  }\n};\n\nconst faviconDetector = (rule) => {\n        const currentUrl = window.location.href;\n        getFaviconHash(currentUrl).then(faviconHash => {\n        if (faviconHash && faviconHash === rule.hash) {\n          useLogging && console.debug(\"Favicon MD5 match detected:\", faviconHash, rule);\n          if (heuristicsUrlsToBlock) {\n            heuristicsUrlsToBlock.add({\n              domain: currentUrl,\n              isSilent: typeof rule.isSilent !== 'undefined' ? rule.isSilent : true,\n              isAggressiveMode: typeof rule.isAggressiveMode !== 'undefined' ? rule.isAggressiveMode : false,\n              type: rule.ruleType as RuleType,\n              source: `:fmd5(${rule.hash})`,\n              id: rule.id || 0,\n            });\n          }\n        }\n      }).catch(error => {\n        useLogging && console.error(\"Error checking favicon hash:\", error);\n      });\n}\n/**\n * Filter elements that contain specific text patterns\n * @param elements - Array of DOM elements to filter\n * @param rule - Contains selector rule with text patterns\n * @returns Array of elements that match the text patterns\n */\nconst filterByContains = (\n  elements: Element[],\n  rule: ContainsSelector\n): Element[] => {\n  // Create a single regex pattern that matches any of the text patterns\n  const regexPattern =\n    rule.text.startsWith(\"/\") && rule.text.endsWith(\"/\")\n      ? new RegExp(rule.text.slice(1, -1), \"i\")\n      : new RegExp(`${rule.text}`, \"i\");\n  return elements.filter((element) => {\n    const elementText = element.textContent ?? \"\";\n    let normalizedSearchText = elementText.toLowerCase().trim();\n    return regexPattern.test(normalizedSearchText);\n  });\n};\n\nfunction filterNone() {\n  return NodeFilter.FILTER_ACCEPT;\n}\n\nfunction getAllComments(rootElem) {\n  let comments: Element[] = [];\n  // Fourth argument, which is actually obsolete according to the DOM4 standard, is required in IE 11\n  let iterator = document.createNodeIterator(\n    rootElem,\n    NodeFilter.SHOW_COMMENT,\n    filterNone\n  );\n  let curNode;\n  while ((curNode = iterator.nextNode())) {\n    comments.push(curNode);\n  }\n  return comments;\n}\n\nconst filterByComments = (rule: CommentsSelector): Element[] => {\n  let comments = getAllComments(document.documentElement);\n  const regexPattern =\n    rule.text.startsWith(\"/\") && rule.text.endsWith(\"/\")\n      ? new RegExp(rule.text.slice(1, -1), \"i\")\n      : new RegExp(`${rule.text}`, \"i\");\n  return comments.filter((commentElement) => {\n    const elementText: string = commentElement.textContent ?? \"\";\n    let normalizedSearchText = elementText.toLowerCase().trim();\n    return regexPattern.test(normalizedSearchText);\n  });\n};\n\n/**\n * Filter elements that have child elements matching selectors\n */\nconst filterByHas = (elements: Element[], rule: HasSelector): Element[] => {\n  return elements.filter((element) => {\n    const childElements = getElementsByRule(rule.selectors);\n    const hasMatchingChild = childElements.some((child) =>\n      element.contains(child)\n    );\n    if (!hasMatchingChild) return false;\n    return hasMatchingChild;\n  });\n};\n\n/**\n * Filter elements that don't match the given selectors\n */\nconst filterByNot = (\n  matchingElements: Element[],\n  rule: NotSelector\n): Element[] => {\n  const excludedElements = getElementsByRule(rule.selectors);\n  return matchingElements.filter(\n    (element) => !excludedElements.includes(element)\n  );\n};\n\n/**\n * Filter elements by computed style properties\n */\nconst filterByProperties = (\n  elements: Element[],\n  rule: PropertiesSelector\n): Element[] => {\n  const cleanedStyle = rule.propertyFilter.trim(); // only trim, dont remove spaces.\n  if (cleanedStyle.length === 0) return [];\n\n  const propsKeys = cleanedStyle\n    .split(\";\")\n    .map((oneStyle) => oneStyle.split(\":\")[0].trim());\n\n  const dummyElement = createDummyHTMLElement(cleanedStyle);\n  document.body.appendChild(dummyElement);\n\n  elements = elements.filter((element) => {\n    if (!(element instanceof HTMLElement)) return false;\n\n    return hasAllStyles(element, dummyElement, propsKeys);\n  });\n\n  document.body.removeChild(dummyElement);\n\n  return elements;\n};\n\n// Function to create a dummy element with the given styles\nfunction createDummyHTMLElement(styleString: string): HTMLElement {\n  const dummyElement = document.createElement(\"section\");\n  const forceHide = \"display: none !important;\";\n\n  // make sure the dummy element is not visible\n  dummyElement.style.cssText = styleString + forceHide;\n\n  return dummyElement;\n}\n\n// Function to compare computed styles of two elements\nfunction hasAllStyles(\n  realElement: HTMLElement,\n  dummyElement: HTMLElement,\n  properties: string[]\n): Boolean {\n  // Get computed styles for both elements\n  const realComputedStyle = window.getComputedStyle(realElement);\n  const dummyComputedStyle = window.getComputedStyle(dummyElement);\n\n  // Iterate through all styles in the dummy element\n  for (const property of properties) {\n    const dummyValue = dummyComputedStyle.getPropertyValue(property).trim();\n    const realValue = realComputedStyle.getPropertyValue(property).trim();\n\n    // If the property in dummy doesn't match real, return false\n    if (dummyValue && dummyValue !== realValue) {\n      // Mismatch found for property\n      return false;\n    }\n  }\n\n  // If all styles match, return true\n  return true;\n}\n\n/**\n * Evaluate XPath selector and return matching elements\n */\nconst evaluateXPathSelector = (rule: XPathSelector): Element[] => {\n  try {\n    const result = document.evaluate(\n      rule.xpath,\n      document,\n      null,\n      XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,\n      null\n    );\n\n    const elements: Element[] = [];\n    for (let i = 0; i < result.snapshotLength; i++) {\n      const element = result.snapshotItem(i) as Element;\n      if (element) elements.push(element);\n    }\n    return elements;\n  } catch (error) {\n    useLogging && console.error(\"XPath evaluation error:\", error);\n    return [];\n  }\n};\n\n/**\n * Filter elements by XPath expression\n */\nconst filterByXPath = (elements: Element[], rule: XPathSelector): Element[] => {\n  const xpathElements = evaluateXPathSelector(rule);\n  return elements.filter((element) => xpathElements.includes(element));\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"/\";","/* eslint-disable no-undef, camelcase */\n\n// bow: https://gist.github.com/thejohnfreeman/563337119e20d090ea2d22bee9b05a6b\nif (!chrome && !browser) {\n    window.chrome = chrome || window.chrome || window.browser;\n}\n\n__webpack_public_path__ = (chrome || window.chrome).runtime.getURL('');\n","// Define a unified type\ntype PolyBrowser = typeof chrome & typeof browser;\n\n// Set the global context to the window object if it exists, otherwise use self\nconst GLOBAL_CONTEXT = typeof window !== 'undefined' ? window : self;\n\n// Create a polyBrowser object\nconst polyBrowser: PolyBrowser = (GLOBAL_CONTEXT as any).chrome || GLOBAL_CONTEXT.browser || browser;\n\n// debug what user agent is being used and what is the browser\n\nlet idb: IDBFactory;\ntry {\n  idb = indexedDB || GLOBAL_CONTEXT.indexedDB;\n} catch (error:any) {\n  console.log(`Error initializing indexedDB: ${error.message}`);\n}\n\nconst performancePoly = performance || GLOBAL_CONTEXT.performance;\nconst URLPoly = URL || GLOBAL_CONTEXT.URL;\n\nexport {\n  polyBrowser as chrome,\n  idb as indexedDB,\n  performancePoly as performance,\n  URLPoly as URL,\n};\n","/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */\n\nconst {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor\n} = Object;\nlet {\n  freeze,\n  seal,\n  create\n} = Object; // eslint-disable-line import/no-mutable-exports\nlet {\n  apply,\n  construct\n} = typeof Reflect !== 'undefined' && Reflect;\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\nif (!apply) {\n  apply = function apply(fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\nif (!construct) {\n  construct = function construct(Func, args) {\n    return new Func(...args);\n  };\n}\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySplice = unapply(Array.prototype.splice);\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\nconst regExpTest = unapply(RegExp.prototype.test);\nconst typeErrorCreate = unconstruct(TypeError);\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return function (thisArg) {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return apply(func, thisArg, args);\n  };\n}\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(func) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return construct(func, args);\n  };\n}\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(set, array) {\n  let transformCaseFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n        element = lcElement;\n      }\n    }\n    set[element] = true;\n  }\n  return set;\n}\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n  return array;\n}\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (value && typeof value === 'object' && value.constructor === Object) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n  return newObject;\n}\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n    object = getPrototypeOf(object);\n  }\n  function fallbackValue() {\n    return null;\n  }\n  return fallbackValue;\n}\n\nconst html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\nconst svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nconst svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nconst svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nconst mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']);\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nconst mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nconst text = freeze(['#text']);\n\nconst html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'popover', 'popovertarget', 'popovertargetaction', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'wrap', 'xmlns', 'slot']);\nconst svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'amplitude', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'exponent', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'intercept', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'slope', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'tablevalues', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nconst mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nconst xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n// eslint-disable-next-line unicorn/better-regex\nconst MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nconst ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nconst TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nconst DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nconst ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nconst IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nconst IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nconst ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nconst DOCTYPE_NAME = seal(/^html$/i);\nconst CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n\nvar EXPRESSIONS = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ARIA_ATTR: ARIA_ATTR,\n  ATTR_WHITESPACE: ATTR_WHITESPACE,\n  CUSTOM_ELEMENT: CUSTOM_ELEMENT,\n  DATA_ATTR: DATA_ATTR,\n  DOCTYPE_NAME: DOCTYPE_NAME,\n  ERB_EXPR: ERB_EXPR,\n  IS_ALLOWED_URI: IS_ALLOWED_URI,\n  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n  MUSTACHE_EXPR: MUSTACHE_EXPR,\n  TMPLIT_EXPR: TMPLIT_EXPR\n});\n\n/* eslint-disable @typescript-eslint/indent */\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5,\n  // Deprecated\n  entityNode: 6,\n  // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12 // Deprecated\n};\nconst getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  }\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\nconst _createHooksMap = function _createHooksMap() {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: []\n  };\n};\nfunction createDOMPurify() {\n  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n  const DOMPurify = root => createDOMPurify(root);\n  DOMPurify.version = '3.2.6';\n  DOMPurify.removed = [];\n  if (!window || !window.document || window.document.nodeType !== NODE_TYPE.document || !window.Element) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n  let {\n    document\n  } = window;\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes\n  } = window;\n  const ElementPrototype = Element.prototype;\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName\n  } = document;\n  const {\n    importNode\n  } = originalDocument;\n  let hooks = _createHooksMap();\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT\n  } = EXPRESSIONS;\n  let {\n    IS_ALLOWED_URI: IS_ALLOWED_URI$1\n  } = EXPRESSIONS;\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n  const formElement = document.createElement('form');\n  const isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function _parseConfig() {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE =\n    // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS') ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR') ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES') ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR') ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR, transformCaseFunc) : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS') ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS, transformCaseFunc) : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS') ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS') ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : clone({});\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR') ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : clone({});\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES') ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS = cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS = cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n      }\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n      }\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n      }\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n    CONFIG = cfg;\n  };\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);\n  const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function _checkValidNamespace(element) {\n    let parent = getParentNode(element);\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template'\n      };\n    }\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      }\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    }\n    // For XHTML and XML documents that support custom namespaces\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return true;\n    }\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function _removeAttribute(name, element) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element\n      });\n    }\n    element.removeAttribute(name);\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n    const body = doc.body || doc.documentElement;\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function _createNodeIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root,\n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION, null);\n  };\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function _isClobbered(element) {\n    return element instanceof HTMLFormElement && (typeof element.nodeName !== 'string' || typeof element.textContent !== 'string' || typeof element.removeChild !== 'function' || !(element.attributes instanceof NamedNodeMap) || typeof element.removeAttribute !== 'function' || typeof element.setAttribute !== 'function' || typeof element.namespaceURI !== 'string' || typeof element.insertBefore !== 'function' || typeof element.hasChildNodes !== 'function');\n  };\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function _isNode(value) {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n  function _executeHooks(hooks, currentNode, data) {\n    arrayForEach(hooks, hook => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function _sanitizeElements(currentNode) {\n    let content = null;\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (SAFE_FOR_XML && currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\\w!]/g, currentNode.innerHTML) && regExpTest(/<[/\\w!]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any kind of possibly harmful comments */\n    if (SAFE_FOR_XML && currentNode.nodeType === NODE_TYPE.comment && regExpTest(/<[/\\w]/g, currentNode.data)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {\n          return false;\n        }\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {\n          return false;\n        }\n      }\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        content = stringReplace(content, expr, ' ');\n      });\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n    return false;\n  };\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n      // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) ||\n      // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n      return false;\n    } else ;\n    return true;\n  };\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function _isBasicCustomElement(tagName) {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n    const {\n      attributes\n    } = currentNode;\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined\n    };\n    let l = attributes.length;\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const {\n        name,\n        namespaceURI,\n        value: attrValue\n      } = attr;\n      const lcName = transformCaseFunc(name);\n      const initValue = attrValue;\n      let value = name === 'value' ? initValue : stringTrim(initValue);\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n      /* Work around a security issue with comments inside attributes */\n      if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\\/(style|title)/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Handle attributes that require Trusted Types */\n      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              {\n                value = trustedTypesPolicy.createHTML(value);\n                break;\n              }\n            case 'TrustedScriptURL':\n              {\n                value = trustedTypesPolicy.createScriptURL(value);\n                break;\n              }\n          }\n        }\n      }\n      /* Handle invalid data-* attribute set by try-catching it */\n      if (value !== initValue) {\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n          if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n          } else {\n            arrayPop(DOMPurify.removed);\n          }\n        } catch (_) {\n          _removeAttribute(name, currentNode);\n        }\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty) {\n    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === NODE_TYPE.element && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n      // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n    /* Now start iterating over the created document */\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n      return returnNode;\n    }\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    /* Serialize doctype if allowed */\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n  DOMPurify.setConfig = function () {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n  DOMPurify.removeHook = function (entryPoint, hookFunction) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n      return index === -1 ? undefined : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n    return arrayPop(hooks[entryPoint]);\n  };\n  DOMPurify.removeHooks = function (entryPoint) {\n    hooks[entryPoint] = [];\n  };\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n  return DOMPurify;\n}\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.mjs.map\n","import {chrome} from '../utils/polyfill.ts';\nimport {\n    heuristicsElementsToRemove,\n    processHeuristics,\n    processHeuristicsRules\n} from \"@/content-scripts/heuristics-db/content-heuristics\";\nimport DOMPurify from \"dompurify\";\n\nif (window.location.href === \"https://www.malwarebytes.com/browserguard/download-debug-logs?yes=true\") {\n    window.location.href = chrome.runtime.getURL('app/eventpages/downloading.html');\n}\n\nconst runHeuristicsRulesEditorScript = () => {\n\n    const ELEMENT_IDS = {\n        RULE_INPUT: \"rule-input\",\n        ADD_RULE: \"add-rule\",\n        EXECUTE: \"execute-test\",\n        RULE_PREVIEW: \"rule-object-preview\",\n        ERRORS_PREVIEW: \"errors-preview\",\n        LOAD_RULES: \"load-rules-from-storage\",\n        REMOVE_RULES: \"remove-rules-from-storage\",\n        HTML_PREVIEW_CONTENT: \"html-preview-content\",\n        URL_INPUT: \"url-input\",\n    };\n\n    const STORAGE_KEY = \"heuristics-rules\";\n    const DEFAULT_RULE_TYPE = \"adserver\";\n    const DEFAULT_RULE_DESCRIPTION = \"Heuristic\";\n    const HREF = document.location.href;\n    // State management\n    let rulesArray = [];\n\n    // Storage functions\n    const saveRules = () => {\n        try {\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(rulesArray));\n        } catch (error) {\n            console.error(\"Error saving rules:\", error);\n        }\n    };\n\n    const removeRules = () => {\n        try {\n            localStorage.removeItem(STORAGE_KEY);\n            rulesArray = [];\n            updateRulePreview();\n        } catch (error) {\n            console.error(\"Error removing rules:\", error);\n        }\n    };\n\n    const loadRules = () => {\n        try {\n            const savedRules = localStorage.getItem(STORAGE_KEY);\n            if (savedRules) {\n                rulesArray = JSON.parse(savedRules);\n                updateRulePreview();\n            }\n        } catch (error) {\n            console.error(\"Error loading rules:\", error);\n            rulesArray = [];\n        }\n    };\n\n    // Helper functions\n    const validateRule = (ruleString) => {\n        if (!ruleString || typeof ruleString !== \"string\") {\n            throw new Error(\"Invalid rule format: Rule must be a non-empty string\");\n        }\n        return ruleString.trim();\n    };\n\n    const createRuleObject = (ruleString) => {\n        return {\n            r: ruleString, // rule string\n            s: false, // status\n            t: DEFAULT_RULE_TYPE,\n            d: DEFAULT_RULE_DESCRIPTION,\n        };\n    };\n\n    const updateRulePreview = () => {\n        if (elements.rulePreview) {\n            elements.rulePreview.innerHTML = JSON.stringify(rulesArray, null, 2);\n        }\n    };\n\n    // DOM Element References\n    const elements = {\n        addRuleButton: document.getElementById(ELEMENT_IDS.ADD_RULE),\n        executeRuleButton: document.getElementById(ELEMENT_IDS.EXECUTE),\n        rulePreview: document.getElementById(ELEMENT_IDS.RULE_PREVIEW),\n        errorsPreview: document.getElementById(ELEMENT_IDS.ERRORS_PREVIEW),\n        ruleInput: document.getElementById(ELEMENT_IDS.RULE_INPUT),\n        loadRules: document.getElementById(ELEMENT_IDS.LOAD_RULES),\n        removeRules: document.getElementById(ELEMENT_IDS.REMOVE_RULES),\n        htmlPreviewContent: document.getElementById(ELEMENT_IDS.HTML_PREVIEW_CONTENT),\n        urlInput: document.getElementById(ELEMENT_IDS.URL_INPUT),\n    };\n\n    // Validate DOM elements\n    let elementsAreValid = true;\n    Object.entries(elements).forEach(([key, element]) => {\n        if (!element) {\n            elementsAreValid = false;\n            console.warn(`Required element \"${key}\" not found in the DOM`);\n        }\n    });\n    if (!elementsAreValid) {\n        console.error(\"One or more required elements are missing. Exiting script.\");\n        return;\n    }\n\n    // Event Handlers\n    const submitRules = () => {\n        elements.errorsPreview.innerHTML = \"\";\n        try {\n            const ruleString = elements.ruleInput.value;\n            const validatedRule = validateRule(ruleString);\n            const ruleObject = createRuleObject(validatedRule);\n            rulesArray.push(ruleObject);\n\n            // Save to localStorage\n            saveRules();\n\n            // Update preview\n            updateRulePreview();\n\n            // Clear input after successful addition\n            elements.ruleInput.value = \"\";\n\n            // Optional: Provide user feedback\n            console.log(\"Rule added successfully:\", ruleObject);\n        } catch (error) {\n            console.error(\"Error adding rule:\", error.message);\n            elements.errorsPreview.innerHTML = `<p style=\"color:red\">Error: ${DOMPurify.sanitize(error.message)}</p>`;\n        }\n    };\n\n    const isChild = (element, container) => {\n        let parent = element.parentNode;\n        while (parent) {\n            if (parent === container) {\n                return true;\n            }\n            parent = parent.parentNode;\n        }\n        return false;\n    };\n    const executeRules = async () => {\n        elements.errorsPreview.innerHTML = \"\";\n        try {\n            const url = elements.urlInput.value;\n            if (rulesArray.length === 0) {\n                throw new Error(\"No rules to process\");\n            }\n\n            const processedRules = await processHeuristics(rulesArray);\n            elements.rulePreview.innerHTML = JSON.stringify(processedRules, null, 2);\n            await processHeuristicsRules(processedRules, url || HREF);\n            \n            heuristicsElementsToRemove.forEach((node) => {\n                const container = elements.htmlPreviewContent;\n                if (isChild(node, container)) {\n                    node.style.borderColor = \"red\";\n                    node.style.borderWidth = \"3px\";\n                    node.style.borderStyle = \"solid\";\n                    node.style.setProperty(\n                        \"-webkit-animation\",\n                        \"borderBlinkHeuristic 1s step-end infinite\",\n                        \"important\"\n                    );\n                    node.style.setProperty(\n                        \"animation\",\n                        \"borderBlinkHeuristic 1s step-end infinite\",\n                        \"important\"\n                    );\n                }\n            });\n        } catch (error) {\n            console.error(\"Error processing rules:\", error.message);\n            elements.errorsPreview.innerHTML = `Error: ${DOMPurify.sanitize(error.message)}`;\n        }\n    };\n\n    // Event Listeners\n    elements.addRuleButton.addEventListener(\"click\", submitRules);\n    elements.loadRules.addEventListener(\"click\", loadRules);\n    elements.removeRules.addEventListener(\"click\", removeRules);\n    elements.executeRuleButton.addEventListener(\"click\", executeRules);\n}\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n    setTimeout(() => {\n        runHeuristicsRulesEditorScript();\n    }, 1500);\n});\n"],"names":["ElementHidingSelectors","Actions","RuleType","COMPLEX_OPERATORS_REGEX","ACTION_OPERATORS_REGEX","SelectorParser","parseSelectorContent","content","startIndex","parens","i","length","c","text","substring","end","parseSelector","selector","isSilent","isAggressiveMode","id","type","matchedAction","exec","this","parseActionOperator","match","raw","selectors","index","push","SyntaxError","ruleType","hash","propertyFilter","hasSelectors","xpath","notSelectors","Array","isArray","every","s","rest","action","input","Object","freeze","LicenseStateUnknown","LicenseStateFree","LicenseStateTrial","LicenseStateTrialExpired","LicenseStateLicensed","LicenseStateLicenseExpired","LicenseStateLicenseGrace","MALWARE","FULL_URL_MALWARE","SUSPICIOUS_PAGE","SUSPICIOUS_TLD","RISKY_PATTERN","SUSPICIOUS_CONTENT","MALWARE_PATTERN","ALERT_LOOP","AUTH_REQUIRED_LOOP","CREATE_URL_LOOP","EXTENSION_INSTALL","FULL_SCREEN_LOOP","HISTORY_LOOP","NOTIFICATION_LOOP","PRINT_LOOP","ADWARE","REPUTATION","TROJAN","MALVERTISING","WORM","RANSOMWARE","ROOTKIT","BACKDOOR","SPYWARE","ALLOWED_EXCLUSION_VALUE","SCAM","TSS","SCAM_HEURISTIC","PHISHING","PHISHING_SUSPICIOUS_POST","PHISHING_BANKING","PHISHING_LOGIN","PHISHING_LOGIN_VIA_TUNNEL","TELEMETRY_PHISHING_TUNNEL","AD","ADSERVER","ADS","CHROME","FIREFOX","OPERA","EDGE","SAFARI","origins","permissions","optional_permissions","ruleSeparatorRegexInstance","RegExp","Chrome","Firefox","Edge","Safari","clipboardRead","title","description","clipboardWrite","alarms","downloads","storage","tabs","declarativeNetRequest","declarativeNetRequestFeedback","unlimitedStorage","webRequest","contextMenus","nativeMessaging","offscreen","activeTab","useLogging","heuristicsElementsToRemove","Set","heuristicsUrlsToBlock","processHeuristicsRules","async","processedRules","currentUrl","currentDomain","URL","hostname","parser","entries","forEach","rules","o","keys","isPageBlock","includes","selectorsType","selectorsByDomain","console","warn","href","parsedSelectorsToReturn","domainRegex","applyForDomain","checkUrlAgainstCurrentDomain","processSelectorsByDomain","selectorArrays","allSelectorsMatched","aSelector","parsedSelectors","elements","getElementsByRule","element","add","error","domain","source","pattern","test","processHeuristics","heuristicsContent","adserver","whitelist","scam","phishing","cleanName","version","name","rule","isValidHeuristicsRule","r","ruleContent","t","a","params","processRule","splitRule","split","firstRule","separator","ruleSelector","result","debug","restParams","dissectedRules","trim","processedSelectors","separatorStr","item","replace","typedRule","isValidRuleType","isFirstRule","processInitialSimpleSelectors","filterElementsByRule","document","from","querySelectorAll","CLICK_ON_ELEMENT","HTMLElement","click","REMOVE_ELEMENT","remove","startsWith","endsWith","regex","slice","filter","textContent","prev","querySelector","log","evaluateXPathSelector","matches","filterByContains","filterByComments","filterByHas","filterByNot","filterByProperties","filterByXPath","regexPattern","normalizedSearchText","toLowerCase","filterNone","NodeFilter","FILTER_ACCEPT","comments","rootElem","curNode","iterator","createNodeIterator","SHOW_COMMENT","nextNode","getAllComments","documentElement","commentElement","some","child","contains","matchingElements","excludedElements","cleanedStyle","propsKeys","map","oneStyle","dummyElement","styleString","createElement","style","cssText","createDummyHTMLElement","body","appendChild","realElement","properties","realComputedStyle","window","getComputedStyle","dummyComputedStyle","property","dummyValue","getPropertyValue","realValue","hasAllStyles","removeChild","evaluate","XPathResult","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","snapshotItem","xpathElements","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","p","chrome","browser","__webpack_public_path__","runtime","getURL","GLOBAL_CONTEXT","self","polyBrowser","idb","indexedDB","message","performance","setPrototypeOf","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","seal","create","apply","construct","Reflect","x","fun","thisValue","args","Func","arrayForEach","unapply","arrayLastIndexOf","lastIndexOf","arrayPop","pop","arrayPush","arraySplice","splice","stringToLowerCase","String","stringToString","toString","stringMatch","stringReplace","stringIndexOf","indexOf","stringTrim","objectHasOwnProperty","regExpTest","typeErrorCreate","func","TypeError","_len2","arguments","_key2","thisArg","lastIndex","_len","_key","addToSet","set","array","transformCaseFunc","l","lcElement","cleanArray","clone","object","newObject","value","constructor","lookupGetter","desc","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","html","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","CUSTOM_ELEMENT","EXPRESSIONS","__proto__","getGlobal","purify","createDOMPurify","DOMPurify","root","removed","nodeType","Element","isSupported","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","Node","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","trustedTypes","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","ownerDocument","trustedTypesPolicy","emptyHTML","implementation","createDocumentFragment","getElementsByTagName","importNode","hooks","afterSanitizeAttributes","afterSanitizeElements","afterSanitizeShadowDOM","beforeSanitizeAttributes","beforeSanitizeElements","beforeSanitizeShadowDOM","uponSanitizeAttribute","uponSanitizeElement","uponSanitizeShadowNode","createHTMLDocument","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","tagNameCheck","writable","configurable","attributeNameCheck","allowCustomizedBuiltInElements","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","SAFE_FOR_XML","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","CONFIG","formElement","isRegexOrFunction","testValue","Function","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","TRUSTED_TYPES_POLICY","createHTML","createScriptURL","purifyHostElement","createPolicy","suffix","ATTR_NAME","hasAttribute","getAttribute","policyName","scriptUrl","_","_createTrustedTypesPolicy","ALL_SVG_TAGS","ALL_MATHML_TAGS","_forceRemove","node","_removeAttribute","attribute","getAttributeNode","removeAttribute","setAttribute","_initDocument","dirty","doc","leadingWhitespace","dirtyPayload","parseFromString","createDocument","innerHTML","insertBefore","createTextNode","childNodes","_createNodeIterator","SHOW_ELEMENT","SHOW_TEXT","SHOW_PROCESSING_INSTRUCTION","SHOW_CDATA_SECTION","_isClobbered","nodeName","attributes","namespaceURI","hasChildNodes","_isNode","_executeHooks","currentNode","data","hook","_sanitizeElements","tagName","allowedTags","firstElementChild","_isBasicCustomElement","parentNode","childClone","__removalCount","parent","parentTagName","Boolean","_checkValidNamespace","expr","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","forceKeepAttr","attr","initValue","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","sanitize","importedNode","returnNode","firstChild","nodeIterator","shadowroot","shadowrootmode","serializedHTML","outerHTML","doctype","setConfig","clearConfig","isValidAttribute","tag","addHook","entryPoint","hookFunction","removeHook","removeHooks","removeAllHooks","location","addEventListener","setTimeout","runHeuristicsRulesEditorScript","STORAGE_KEY","HREF","rulesArray","updateRulePreview","rulePreview","JSON","stringify","addRuleButton","getElementById","executeRuleButton","errorsPreview","ruleInput","loadRules","removeRules","htmlPreviewContent","urlInput","elementsAreValid","submitRules","ruleObject","ruleString","Error","validateRule","saveRules","localStorage","setItem","savedRules","getItem","parse","removeItem","url","isChild","container","borderColor","borderWidth","borderStyle","setProperty"],"sourceRoot":""}